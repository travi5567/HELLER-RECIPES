!function($){$.fn.jqm=function(n){return this.each(function(){var t=$(this),o=t.data("jqm")||$.extend({ID:u++},$.jqm.params),e=$.extend(o,n);t.data("jqm",e).addClass("jqm-init"),e.trigger&&t.jqmAddTrigger(e.trigger)})},$.fn.jqmAddTrigger=function(t){return this.each(function(){a($(this),"jqmShow",t)||n("jqmAddTrigger must be called on initialized modals")})},$.fn.jqmAddClose=function(t){return this.each(function(){a($(this),"jqmHide",t)||n("jqmAddClose must be called on initialized modals")})},$.fn.jqmShow=function(n){return this.each(function(){!this._jqmShown&&t($(this),n)})},$.fn.jqmHide=function(n){return this.each(function(){this._jqmShown&&o($(this),n)})};var n=function(n){window.console&&window.console.error&&window.console.error(n)},t=function(n,t){var o=n.data("jqm"),t=t||window.event,e=parseInt(n.css("z-index")),e=e>0?e:3e3,i=$("<div></div>").addClass(o.overlayClass).css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":e-1,opacity:o.overlay/100}),a={w:n,c:o,o:i,t:t};if(n.css("z-index",e),o.ajax){var r=o.target||n,d=o.ajax;r="string"==typeof r?$(r,n):$(r),"@"==d.substr(0,1)&&(d=$(t).attr(d.substring(1))),r.html(o.ajaxText).load(d,function(){o.onLoad&&o.onLoad.call(this,a),s(a)})}else s(a)},o=function(n,t){var o=n.data("jqm"),t=t||window.event,e={w:n,c:o,o:n.data("jqmv"),t:t};r(e)},e=function(n){return n.c.overlay>0&&n.o.prependTo("body"),n.w.show(),$.jqm.focusFunc(n.w),!0},i=function(n){return n.w.hide()&&n.o&&n.o.remove(),!0},a=function(n,t,o){var e=n.data("jqm");return n.data("jqm")?$(o).each(function(){this[t]=this[t]||[],$.inArray(e.ID,this[t])<0&&(this[t].push(e.ID),$(this).click(function(){var o=this;return n[t](this),!1}))}):!1},s=function(n){var t=n.w,o=n.o,e=n.c;e.onShow(n)!==!1&&(t[0]._jqmShown=!0,e.modal?(!m[0]&&d("bind"),m.push(t)):t.jqmAddClose(o),e.closeClass&&t.jqmAddClose($("."+e.closeClass,t)),e.toTop&&o&&t.before('<span id="jqmP'+e.ID+'"></span>').insertAfter(o),t.data("jqmv",o))},r=function(n){var t=n.w,o=n.o,e=n.c;e.onHide(n)!==!1&&(t[0]._jqmShown=!1,e.modal&&(m.pop(),!m[0]&&d("unbind")),e.toTop&&o&&$("#jqmP"+e.ID).after(t).remove())},d=function(n){$(document)[n]("keypress keydown mousedown",c)},c=function(n){var t=$(n.target).data("jqm")||$(n.target).parents(".jqm-init:first").data("jqm"),o=m[m.length-1].data("jqm");return t&&t.ID==o.ID?!0:$.jqm.focusFunc(o)},u=0,m=[];$.jqm={params:{overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:!1,target:!1,ajaxText:"",modal:!1,toTop:!1,onShow:e,onHide:i,onLoad:!1},focusFunc:function(n){return $(":input:visible:first",n).focus(),!1}}}(jQuery);